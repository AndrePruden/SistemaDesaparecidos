<div class="form-container">
  <h2>{{ isEditing ? 'Editar Avistamiento' : 'Reportar Nuevo Avistamiento' }}</h2>

  <form (ngSubmit)="onSubmit()" #avistamientoForm="ngForm">
    <div class="form-group">
      <label for="fecha">Fecha del avistamiento</label>
      <input type="date" id="fecha" name="fecha" [(ngModel)]="avistamientoFormData.fecha" required />
    </div>

    <div class="form-group">
      <label for="lugar">Lugar del avistamiento</label>
      <p>Selecciona la ubicación en el mapa haciendo click.</p>
    </div>

    <div #mapContainer id="mapaFormAvistamiento" style="height: 300px; margin-bottom: 1em;"></div>

    <div class="form-group">
      <label for="descripcion">Descripción</label>
      <textarea id="descripcion" name="descripcion" [(ngModel)]="avistamientoFormData.descripcion" placeholder="Describe lo que viste..." rows="4"></textarea>
    </div>

    <div class="form-group">
      <label for="personaDesaparecida">Seleccionar Reporte</label>
      <select id="personaDesaparecida" name="personaDesaparecida" [(ngModel)]="avistamientoFormData.personaDesaparecida.idDesaparecido" required>
        <option [ngValue]="null" disabled selected>-- Selecciona un reporte --</option>
        <option *ngFor="let reporte of reportes" [value]="reporte.idDesaparecido">
          {{ reporte.nombre }}
        </option>
      </select>
    </div>

    <button type="submit" [disabled]="!avistamientoForm.form.valid || isLoading">
      {{ isEditing ? 'Actualizar Avistamiento' : 'Enviar Avistamiento' }}
    </button>

   <button type="button" *ngIf="isEditing" class="btn-cancelar" (click)="router.navigate(['/reportes'])">
        Cancelar
    </button>

    <div *ngIf="mensaje" class="mensaje-info">
        {{ mensaje }}
    </div>
  </form>
</div>